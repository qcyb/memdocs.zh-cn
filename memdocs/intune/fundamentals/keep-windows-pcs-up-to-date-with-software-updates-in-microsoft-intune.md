---
title: 适用于 Windows PC 的软件更新
titleSuffix: Microsoft Intune
description: Intune 通过确保向托管计算机快速安装最新修补程序和软件，使该计算机保持最新版本。
keywords: ''
author: dougeby
ms.author: dougeby
manager: dougeby
ms.date: 01/01/2018
ms.topic: archived
ms.service: microsoft-intune
ms.subservice: fundamentals
ms.localizationpriority: medium
ms.assetid: 48e9c41a-d2de-424e-9610-cfd1ad514210
ms.reviewer: owenyen
ms.suite: ems
search.appverid: MET150
ms.custom: intune-classic-keep
ms.collection: M365-identity-device-management
ms.openlocfilehash: 9a1a5b291135f5c6d42a47377d14d6d3d4f13411
ms.sourcegitcommit: 3d895be2844bda2177c2c85dc2f09612a1be5490
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/13/2020
ms.locfileid: "79362324"
---
# <a name="keep-windows-pcs-up-to-date-with-software-updates-in-microsoft-intune"></a>在 Microsoft Intune 中利用软件更新使 Windows 电脑保持最新版本

[!INCLUDE [classic-portal](../includes/classic-portal.md)]

> [!NOTE]
> 本主题中的信息仅适用于通过使用 Intune 软件客户端作为电脑进行管理的 Windows 桌面。 如果要管理注册为移动设备的 Windows 电脑的更新，请参阅[在 Intune 中管理软件更新](../protect/windows-update-for-business-configure.md)。

Microsoft Intune 可通过多种方式帮助保护托管计算机，其中包括管理软件更新，它通过确保快速安装最新修补程序和软件更新，使计算机保持最新版本。

如果你尚未在计算机上安装 Intune 客户端，请参阅[使用 Microsoft Intune 安装 Windows 电脑客户端](install-the-windows-pc-client-with-microsoft-intune.md)。

当 Microsoft 更新中有新的更新可用或你创建了第三方更新，并且这些更新适用于托管计算机时，“更新”  工作区的“概述”  页上将显示一条通知。 单击此通知链接后，你可以执行各种操作，如查看有关更新的详细信息、批准或拒绝更新，以及查看将在更新获得批准的情况下安装更新的计算机。

> [!IMPORTANT]
> 直到客户端已被安装，并成功管理至少一台计算机客户端，“更新”  工作区才会显示在管理员控制台中。

批准并安装更新后，可以在 Intune 工作台的“更新”  工作区中查看安装是成功还是失败。

下列部分将帮助你让托管计算机上的软件保持最新版本。

## <a name="before-you-start"></a>开始之前
在开始创建和批准软件更新之前，请配置用于控制更新安装时间和方式的策略并将其部署到你的计算机。

### <a name="to-configure-update-policy-settings"></a>配置更新策略设置

1. 在 [Microsoft Intune 管理控制台](https://manage.microsoft.com/)中，选择“策略”&gt;“概述”&gt;“添加策略”    。

2. 为更新设置配置和部署 **Microsoft Intune 代理设置** 策略。 你可以使用建议的设置，或对设置进行自定义。 如果你需要有关如何创建和部署策略的详细信息，请参阅[使用 Microsoft Intune 计算机客户端的常见 Windows 电脑管理任务](common-windows-pc-management-tasks-with-the-microsoft-intune-computer-client.md)。

下表显示你可在策略中配置的值，还显示将在你未自定义策略的情况下使用的建议值。 你可以在“更新”  部分找到这些设置。

  |策略设置|详细信息|
    |------------------|--------------------|
    |**更新和应用程序检测频率（小时）** |指定 Intune 检查更新和新应用程序的频率（间隔 8-22 小时）。<br /><br />建议的值：8 小时  。|
    |**自动安装或提示安装更新和应用程序** |指定是否自动安装更新，或者是否在安装之前提示用户。 此外，这些设置可让你计划更新和应用程序的安装。<br /><br />“按计划自动安装更新和应用程序”  会使用指定的计划安装更新和应用程序。<br /><br />作为相关的策略设置，“为 Windows 计算机使用自动维护”   指定在 Windows 自动维护时限内安装更新和应用程序。<br /><br />“提示用户进行安装”  会在更新准备好时提示用户进行安装。<br /><br />建议的值：<br /><br />选择“按计划自动安装更新和应用程序” <br /><br />计划日期：  每天<br /><br />计划时间：  凌晨 3 点<br /><br />选择“为 Windows 计算机使用自动维护” |
    |**允许立即安装不会中断 Windows 的更新** |如果为“允许”  ，则在下载更新后立即安装更新（将中断或重启 Windows 的更新除外）。 那些更新会按照“自动安装或提示安装的更新”  设置的配置进行安装。<br /><br />如果为“不允许”  ，则按照“自动安装或提示安装的更新”  设置的配置来安装更新。<br /><br />建议的值：**允许** |
    |**安装计划更新和应用程序后延迟重新启动 Windows (分钟)** |指定在安装计划的更新和应用程序后等待重启 Windows 的时间（1-30 分钟）。<br /><br />建议的值：15 分钟  |
    |**Windows 重新启动后开始安装错过的已计划更新和应用程序的延迟时间（分钟）** |指定在错过计划的更新后，在重启 Windows 多长时间后开始安装更新和应用程序（1-60 分钟）。<br /><br />建议的值：5 分钟 |
    |**在计划的更新和应用程序安装后允许登录的用户控制 Windows 重启** |指定登录的用户是否能延迟重启 Windows（如果设置为“是”  ），或者在 Windows 自动重启时收到通知（如果设置为“否”  ）。 如果在计划的更新和应用程序安装完成时没有用户登录，则 Windows 将在需要时自动重启。 如果设置为“否”  ，默认情况下，Windows 重启之前的时间设置为 5 分钟。<br /><br />建议的值：**是**|
    |**提示用户在执行 Intune 客户端代理强制更新过程中重启 Windows** |指定在 Intune 客户端强制更新要求重启 Windows 时是否提示登录的用户重启 Windows。<br /><br />建议的值：**是**|
    |**Microsoft Intune 客户端代理必备更新安装计划** |计划何时安装客户端更新。<br /><br />建议值：未配置|
    |**在安装计划的更新和应用程序后重启 Windows 的两次提示之间的延迟时间（分钟）** |指定在以下情况下提示用户重启 Windows 的频率（1-1440 分钟）：安装了需要重启 Windows 的计划更新或应用程序，并且用户延迟了重启。<br /><br />建议的值：30 分钟  |

## <a name="update-software-made-by-microsoft"></a>更新 Microsoft 开发的软件
在更新 Microsoft 软件时，你需要完成的工作很少。 但是，在开始之前，你应配置下列两项：

- **产品类别和更新分类** – 定义要提供给计算机的更新的类别和分类。 例如，你可能会决定只安装 Microsoft Office 的关键更新。

- **自动批准规则** – 这些规则会自动批准指定类型的更新，并减少你的管理开销。 例如，你可能希望自动批准所有关键软件更新。

使用下列两个过程来帮助你准备好使用软件更新：

### <a name="configure-the-product-categories-and-update-classifications-you-want-to-make-available-to-managed-computers"></a>配置要提供给被管理的计算机的产品类别和更新分类

1. 在 [Microsoft Intune 管理控制台](https://manage.microsoft.com/)中，选择“管理”&gt;“更新”   。

2. 在“服务设置:  更新”页的“产品类别”列表中，选择要向计算机提供的更新类别  。 请注意，默认情况下会选择最常用的更新。

    > [!IMPORTANT]
    > 为确保计算机接收到管理员批准的更新，请勿将 Windows Server Update Services (WSUS) 组策略设置“指定 Intranet Microsoft 更新服务位置”  应用到已注册 Intune 的计算机。

3. 在“更新分类”  列表中，选择要提供给被管理的计算机的更新分类。 同样，默认情况下会选择最常用的选项。

4. 单击“保存”  以存储你的选择。

### <a name="to-configure-automatic-approval-rules-for-software-updates"></a>配置软件更新的自动批准规则

1. 在 [Microsoft Intune 管理控制台](https://manage.microsoft.com/)中，选择“管理”&gt;“更新”   。

2. 在“服务器设置: 更新”页的“自动批准规则”部分中，   选择“新建”  。

3. 在创建自动批准规则向导的“常规”  页中，指定规则的名称和可选描述。

4. 在“产品类别”  页上，选择要为其自动批准更新的任何产品。

5. 在“更新分类”  页上，指定要自动批准的更新分类。

6. 在“部署”  页上，执行以下操作：

    - 选择要向其部署新规则的计算机组，然后单击“添加”  。

    - 要指定更新的安装截止时间，请选中“对这些更新强制采用安装截止时间”  复选框，然后在“安装截止时间”  列表中选择安装截止时间。

        > [!NOTE]
        > 如果指定安装截止时间，则在截止时间间隔过后，被管理的计算机可能需要一次或多次重启。

    - 完成后，请选择“下一步”  。

7. 在“摘要”  页上，查看新规则的设置，然后单击“完成”  。

新规则会显示在“服务设置: 更新”   页的“自动批准规则”部分中。

> [!NOTE]
> 创建自动批准规则后，它只会批准未来的更新，而不会自动批准之前已存在于 Intune 中的现有更新。 若要批准这些更新，你需要运行自动批准规则。


### <a name="to-edit-run-or-delete-an-automatically-approved-update-rule"></a>编辑、运行或删除自动批准的更新规则

1. 在 [Microsoft Intune 管理控制台](https://manage.microsoft.com/)中，选择“管理”&gt;“更新”   。

2. 在“自动批准规则”  部分选择一条规则，然后执行下列操作之一：

    - 若要编辑规则，请选择“编辑”，然后在“更新自动批准规则向导”中更改该规则的参数   。

    - 若要运行规则，请单击“运行所选项”  。

    - 若要删除规则，请单击“删除”  。

        > [!NOTE]
        > 删除规则对被删除的规则以前批准的更新不会产生影响。

## <a name="update-software-not-made-by-microsoft"></a>更新非 Microsoft 开发的软件
你可以部署不是由 Microsoft 开发的软件更新。 可通过使用“上载更新”  向导将更新上载到云存储空间中来达到此目的，之后你可以就像批准或拒绝 Microsoft 软件一样批准或拒绝该更新。

### <a name="to-upload-and-configure-a-third-party-update"></a>上载和配置第三方更新

1. 在 [Microsoft Intune 管理控制台](https://manage.microsoft.com/)中，选择“更新”&gt;“概述”&gt;“上传”    。

2. 在“更新文件”  页上，单击“浏览”  以选择安装更新包所需的安装程序文件。 文件可以是 Windows Installer (.msi) 文件、Windows Installer 修补程序 (.msp) 文件或 .exe 程序文件。 你也可以包括与安装程序文件处于同一文件夹中的任何其他文件或文件夹。

    此时会显示要上载的所选文件的总大小。 请注意，此大小不包括未压缩或扩展的安装文件的大小。

3. 指定安装程序文件后，“更新描述”  页会显示 Intune 从软件安装程序文件中提取到的软件信息名称、描述和分类。 你可以选择分类以标记要部署的更新的类型（更新、关键更新、安全更新、更新汇总或 Service Pack）。 完成后单击“下一步”  。

4. 在向导的“要求”  页上，选择体系结构（32 位和/或 64 位），以及此更新将适用的托管计算机的操作系统。

5. 在“检测规则”  页上，指定 Intune 如何确定托管计算机上是否已存在更新。 如果使用默认选项“使用默认检测规则”  ，则 Intune 将始终在每台目标计算机上安装一次更新包。

    > [!NOTE]
    > 如果指定的更新安装程序文件是 Windows Installer 或 .msp 文件，则不会出现向导的“检测规则”  页。 这是因为 Windows Installer 和 .msp 文件包含它们自己的用于检测以前更新安装的说明。

    选择下列一条或多条规则以确定被管理的计算机上是否已安装了更新：

    - **文件存在**

    - **MSI 产品代码存在**

    - **注册表项存在**

6. 提供配置检测规则所需的任何进一步信息，例如文件路径和名称、Windows Installer 产品代码或注册表项，然后单击“下一步”  。

7. 在向导的“先决条件”  页上，你指定必须安装然后才能安装此更新的任何软件。 可以指定“无”  ，选择已添加并由 Intune 托管的软件包，也可以指定以下规则之一来描述软件：

    - **文件存在**

    - **MSI 产品代码存在**

    - **注册表项存在**

8. 提供配置检测规则所需的任何进一步信息，如文件路径和名称、Windows Installer 产品代码或注册表项，然后单击“下一步”  。

9. 在向导的“命令行参数”  页上，你可以向安装命令行中添加任何所需的安装属性，以修改安装程序文件的行为。 例如，某些软件支持可启用无提示安装的 **/q** 属性。 请参阅软件包的文档以了解任何支持的命令行参数。 指定所需的任何命令行参数，然后单击“下一步”  。

    > [!NOTE]
    > 如果更新不支持无提示安装，则无法使用 Intune 安装更新。

10. 在向导的“返回代码”  页上，你可以指定如何解释更新安装中的返回代码。 默认情况下，Intune 使用行业标准返回代码来报告失败的或成功的更新包安装。 提供的返回代码是：

|返回代码|详细信息|
|---------------|------------------|
|**0**|成功|
|**3010**|成功并重新启动|

11. 任何未列出的返回代码被认为是失败。
某些更新对返回代码使用非标准的解释。 在此情况下，你可以指定自己的返回代码解释。

12. 指定或编辑所需的返回代码，然后单击“下一步”  。

13. 在向导的“摘要”  页上，查看将采取的操作，然后单击“上载”  以完成向导。

上载的更新存储在你的 Intune 云存储中。 如果没有足够的可用空间来上载更新包，则将在上载过程中通知你。 直到更新上载开始后，Intune 才能确定是否具有充足的可用空间，因为压缩的安装程序和安装文件在解压缩后需要更多的空间。

将内容上传到 Intune 后，第三方更新将显示在“所有更新”窗格中的“更新”工作区中。   你可以随后批准和部署更新。 有关详细信息，请参阅下面的“批准和拒绝更新”部分。

## <a name="approve-and-decline-updates"></a>批准和拒绝更新
当更新准备就绪可安装时，“更新”  工作区的“更新概述”  页上的“更新状态”  下将显示一条消息。 单击此消息打开“所有更新”  页，查看哪些更新已准备就绪，可供批准。

你可以使用“筛选器”  列表以便更轻松地查找更新。 例如，你可以仅显示失败的更新或被取代的更新。

从列表中选择更新时，你将可使用进一步的命令按下表中所示的方式管理更新：

|任务|详细信息|
|--------|--------------------|
|**查看属性**|显示有关更新的详细信息，包括该更新适用于的计算机的数量。|
|**编辑**|仅适用于非 Microsoft 更新。 允许你编辑更新的属性。|
|**批准**|批准所选更新，并允许你配置将更新部署到哪些组。 有关详细信息，请参阅此主题中的**批准更新**过程。|
|**拒绝**|为更新删除任何以前的批准，并在默认视图中隐藏更新。 此外，将删除更新的任何报表数据。<br /><br />如果你稍后需要查找已拒绝的更新，请在“所有更新”  页上将筛选器设置为“已拒绝”  。 你可以随后根据需要批准此更新。<br /><br />如果更新由于在 Microsoft Update 中过期而被拒绝，则无法在 Intune 管理控制台中批准该更新。<br /><br />如果你删除部署到计算机的更新策略，则这些更新策略设置的值会重置为计算机上安装的操作系统的默认状态。|
|**删除**|仅适用于非 Microsoft 更新。 删除所选更新。|
|**上传**|启动“上传更新”  向导，该向导允许你上传要部署的非 Microsoft 更新。|

### <a name="to-approve-updates"></a>批准更新

1. 在 [Microsoft Intune 管理控制台](https://manage.microsoft.com/)中，选择“更新”&gt;“概述”&gt;“要批准的新更新”    。

    在“更新”工作区中，选择“概述”&gt;“要批准的新更新”    。

    > [!NOTE]
    > “要批准的新更新”  链接在仅当有至少一个需要批准更新的托管计算机时才会显示在“更新状态”  区域中。

2. 选择更新，在页面底部查看更新属性，以确认要批准此更新，然后单击“批准”  。 可通过在选择每一项时按住“CTRL”  键来选择多个更新。

3. 在“选择组”  页上，选择要为其部署更新的组，然后单击“添加”  。 完成指定组后，单击“下一步”  。

4. 在“部署操作”  页上，为列表中的每个组执行下列操作：

    - 在“批准”  列表中，选择下列选项之一：

        - “必需安装”  - 在指定组中的计算机上安装此更新。

        - “不安装”  - 仅报告适用性而不安装更新。

        - **可用安装** – 用户可通过公司门户按需安装应用程序。

        - “卸载”  - 从目标组内的计算机中删除更新。

            > [!IMPORTANT]
            > 即使 Intune 未安装该更新，也会将其删除。

    - 在“截止时间”  列表中，选择下列选项之一：

        - “无”  - 表示没有对更新安装强制实施截止时间，用户可以继续拒绝更新。

        - “尽快”  - 下一个时机到来时在目标计算机上安装更新。

        - “自定义”  - 指定安装已审批更新的日期和时间。

        - **一周**、**两周**、**一个月** – 在指定的时间段内安装更新。

5. 单击“完成”  以保存设置，或者单击“取消”  以放弃设置并返回到更新列表。

    > [!IMPORTANT]
    > 除非显式为子组配置了“不安装”  、“所需的安装”  或“卸载”  操作，否则父组的所有子项将继承为该父组配置的操作。

6. 你可以检查“所有更新”  页底部的详细信息窗格来了解有关更新的提醒消息。


## <a name="see-also"></a>另请参阅
[保护 Windows 电脑的策略](policies-to-protect-windows-pcs-in-microsoft-intune.md)
